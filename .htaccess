# FORCE .php extensions - NO clean URLs allowed
RewriteEngine On

# Redirect clean URLs to .php files (if someone tries to access them)
RewriteRule ^dashboard/?$ dashboard.php [R=301,L]
RewriteRule ^admin/?$ admin.php [R=301,L]
RewriteRule ^profile/?$ profile.php [R=301,L]
RewriteRule ^logout/?$ logout.php [R=301,L]

# Ensure index.php is the default
DirectoryIndex index.php

# Prevent MultiViews from creating clean URLs
Options -MultiViews

# Force .php extension to be required
<IfModule mod_rewrite.c>
    # Don't allow access to files without extensions that match PHP files
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(dashboard|admin|profile|logout)$ $1.php [R=301,L]
</IfModule>

# Security headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
</IfModule>

# Prevent access to sensitive files
<Files ~ "^\.">
    Order allow,deny
    Deny from all
</Files>

<Files ~ "\.sql$">
    Order allow,deny
    Deny from all
</Files>